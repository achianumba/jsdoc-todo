<!-- markdownlint-disable -->

<div align="center">

# JSDoc To Do

Turn "to do" comments in your JavaScript code into a handy checklist in your project's README.md (or a different) file.

</div>

<details>
  <summary><strong style="font-size: 1.5rem">Table of Contents</strong></summary>

- [JSDoc To Do](#jsdoc-to-do)
  - [Features](#features)
  - [Installation](#installation)
  - [Usage](#usage)
    - [Example](#example)
      - [Input](#input)
      - [Output](#output)
    - [Marking a task/to-do as completed.](#marking-a-taskto-do-as-completed)
    - [`todoPlugin` Configuration](#todoplugin-configuration)
  - [Development](#development)
    - [Testing](#testing)
  - [Known issues](#known-issues)
  - [To Do](#to-do)
</details>

## Features

- Extracts "to do" items into an easily accessible checklist.
- Links each "to do" item to it's source file and line number.
- Marks "to do" items as completed directly in JS files.
- Updates "to do" list when `@todo` or `@todolist` comments are added or removed.

## Installation

```shell
npm install -D jsdoc-todo
```

## Usage

1. Add the below to your [JSDoc configuration](https://jsdoc.app/about-configuring-jsdoc) file.
   
    <table border="1" style="table-layout: fixed;">
    <thead>
    <th>JavaScript configuration</th>
    <th>JSON configuration</th>
    </thead>
    <tbody>
    <tr>
    <td style="width: 380px">

      ```javascript
      const { todoPlugin } = require("jsdoc-todo");
      
      module.exports = {
        plugins: [todoPlugin]
      };
      ```

    </td>

    <td style="width: 380px">

      ```json
      {
        "plugins": [
        "node_modules/jsdoc-todo/jsdoc-todo.js"
        ]
      }
      ```

    </td>
    </tr>
    </tbody>
    </table>
2. Run `jsdoc` with the configuration file created in the previous step.
   
   ```shell
   jsdoc -c path/to/jsdoc-config-file .
   ```

> [!NOTE]
`jsdoc-todo` writes the generated "to do" list to a project's README.md file by default. If you wish to have `jsdoc-todo` write the generated "to do" list to a different file, add an `todoPlugin.outFile` property to the project's JSDoc configuration file as shown below.

<br>

<table border="1" style="table-layout: fixed;">
<thead>
<th>JSDoc JavaScript configuration</th>
<th>JSDoc JSON configuration</th>
</thead>
<tbody>
<tr>
<td style="width: 380px">

  ```javascript
  const { todoPlugin } = require("jsdoc-todo");
  
  module.exports = {
    plugins: [todoPlugin],
    todoPlugin: {
      outFile: "some/other/file.md"
    }
  };
  ```

</td>

<td style="width: 380px">

  ```json
  {
    "plugins": [
      "node_modules/jsdoc-todo/jsdoc-todo.js"
    ],
    "todoPlugin": {
      "outFile": "some/other/file.md"
    }
  }
  ```

</td>
</tr>
</tbody>
</table>

<br>

> [!TIP]
> See [todoPlugin](#todoplugin-configuration) for all available `todoPlugin` properties.

### Example

#### Input

  ```javascript
  // example.js
  
  /**
   * @todolist
   * The below will match anything that's an instance of Object (i.e., Arrays, Maps etc.). Use `Object.prototype.toString.call(arg)` instead.
   * Don't forget to test it before your next PR.
   * Consider using Zod's `z.object(arg)` etc. for this and other validators/validations.
   */
  function isObject(arg) {
    if (arg instanceof Object) {
      return true;
    }
  }
  
  /** @todo - Capitalize this and other constant identifiers +x */
  const { NODE_ENV, JWT_PRIVATE_KEY } = process.env;
  
  /**
   * @todo
   * A multi-line @todo item
   * is processed
   * as a single line.
   * Use @todolist tags if you want each line to contain a to do item.
   */
  ```

#### Output

  ```markdown
  <!-- @todolist
  DO NOT MANUALLY EDIT THIS TO DO LIST !!!
  THIS WHOLE SECTION, INCLUDING ITS HEADING IS AUTO-GENERATED BY `jsdoc-todo` plugin.
  ALL MANUAL CHANGES WILL BE OVERWRITTEN THE NEXT TIME jsdoc RUNS !!!!

  IF YOU MUST DIRECTLY/MANUALLY INCLUDE TO DO ITEMS IN THIS DOCUMENT,
  PLEASE ADD THEM DIRECTLY BELOW THE "@endtodolist" HTML COMMENT BELOW. -->

  ## To Do

  - [ ] The below will match anything that's an instance of Object (i.e., Arrays, Maps etc.). Use `Object.prototype.toString.call(arg)` instead.&nbsp;-&nbsp;[review](tests/jsdoc-todo.test.js#L101)
  - [ ] Don't forget to test it before your next PR.&nbsp;-&nbsp;[review](tests/jsdoc-todo.test.js#L102)
  - [ ] Consider using Zod's `z.object(arg)` etc. for this and other validators/validations.&nbsp;-&nbsp;[review](tests/jsdoc-todo.test.js#L103)
  - [x] - Capitalize this and other constant identifiers&nbsp;-&nbsp;[review](tests/jsdoc-todo.test.js#L111)

  <!-- @endtodolist -->
  ```

### Marking a task/to-do as completed.

Append `+x` to the end of a line in a `@todolist` or a single-line `@todo` to mark the task as completed.

If you're working with a multiline `@todo`, append `+x` to the end of the last line instead.

### `todoPlugin` Configuration

| Setting        | Description                             | Type     | Default     |
| -------------- | --------------------------------------- | -------- | ----------- |
| `heading`      | "To Do" section's heading.              | `string` | `To Do`     |
| `headingLevel` | HTML heading type (1 to 6).             | `number` | `2`         |
| `outFile`      | Output file.                            | `number` | `README.md` |
| `tag`          | Marks the start of the "To Do" section. | `string` | `todolist`  |

## Development

```shell
git clone https://github.com/achianumba/jsdoc-todo.git

cd jsdoc-todo

pnpm install

pnpm run build
```

### Testing

```shell
# Run pnpm run build beforehand
pnpm run test
```

## Known issues

- Doesn't support TypeScript.
- Duplicate todo items result from improper filtering in your JSDoc config file. If you're using TypeScript, consider including either the source files' folder or the emitted files folder (but not both) to your JSDoc config's `source.exclude` field.

<!-- @actualToDolist
DO NOT MANUALLY EDIT THIS TO DO LIST !!!
THIS WHOLE SECTION, INCLUDING ITS HEADING IS AUTO-GENERATED BY `jsdoc-todo` plugin.
ALL MANUAL CHANGES WILL BE OVERWRITTEN THE NEXT TIME jsdoc RUNS !!!!

IF YOU MUST DIRECTLY/MANUALLY INCLUDE TO DO ITEMS IN THIS DOCUMENT,
PLEASE ADD THEM DIRECTLY BELOW THE "@endactualToDolist" HTML COMMENT BELOW. -->

## To Do

- [ ] Generate "to do" list from TS files&nbsp;-&nbsp;[review](tests/jsdoc-todo.test.js#L95)
- [ ] Delete todolist section from README.md if no "to do" comments are found in source code.&nbsp;-&nbsp;[review](tests/jsdoc-todo.test.js#L96)

<!-- @endactualToDolist -->
